<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Three.js OBJ Loader with Manual Rotation</title>
    <style>
        body { margin: 0; }
        canvas { display: block; }
    </style>
    <!-- Include Three.js library -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.119/build/three.min.js"></script>
    <!-- Include OBJLoader from Three.js examples -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.119/examples/js/loaders/OBJLoader.js"></script>
    <!-- Include OrbitControls from Three.js examples -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.119/examples/js/controls/OrbitControls.js"></script>
    <!-- Include MTLLoader from Three.js examples -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.119.1/examples/js/loaders/MTLLoader.js"></script>
</head>
<body>
<script type="module">
    let camera, scene, renderer;

    init();

    function init() {

        camera = new THREE.PerspectiveCamera( 45, window.innerWidth / window.innerHeight, 0.1, 20 );
        camera.position.z = 4;
        camera.position.y = 2;
        camera.position.x = 1;


        // scene
        scene = new THREE.Scene();

        const ambientLight = new THREE.AmbientLight( 0xffffff );
        //scene.add( ambientLight );

        const pointLight = new THREE.PointLight( 0xffffff, 1 );
        camera.add( pointLight );
        scene.add( camera );

        // model

        const onProgress = function ( xhr ) {

            if ( xhr.lengthComputable ) {

                const percentComplete = xhr.loaded / xhr.total * 100;
                console.log( percentComplete.toFixed( 2 ) + '% downloaded' );

            }

        };

        new THREE.MTLLoader()
            .setPath( 'male02/' )
            .load( 'pistarlink_model.mtl', function ( materials ) {

                materials.preload();

                new THREE.OBJLoader()
                    .setMaterials( materials )
                    .setPath( 'male02/' )
                    .load( 'pistarlink_model.obj', function ( object ) {

                        object.position.y = - 0.50;
                        object.scale.setScalar( 0.01 );
                        scene.add( object );

                    }, onProgress );

            } );

        //

        renderer = new THREE.WebGLRenderer( { antialias: true } );
        renderer.setPixelRatio( window.devicePixelRatio );
        renderer.setSize( window.innerWidth, window.innerHeight );
        renderer.setAnimationLoop( animate );
        document.body.appendChild( renderer.domElement );

        //

        const controls = new THREE.OrbitControls( camera, renderer.domElement );
        controls.enableZoom = false;
        controls.enablePan = false;

        controls.minDistance = 4.5;
        controls.maxDistance = 4.5;

        //

        window.addEventListener( 'resize', onWindowResize );

    }

    function onWindowResize() {

        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();

        renderer.setSize( window.innerWidth, window.innerHeight );

    }

    function addLaserBeam(scene, startPosition, endPosition, color) {
        const beamLength = startPosition.distanceTo(endPosition);
        const beamGeometry = new THREE.CylinderGeometry(0.01, 0.01, beamLength, 32);

        const beamMaterial = new THREE.MeshBasicMaterial({ color: color, emissive: color });
        const laserBeam = new THREE.Mesh(beamGeometry, beamMaterial);

        // Position the beam in the middle of the start and end points
        const midPoint = startPosition.clone().lerp(endPosition, 0.5);
        laserBeam.position.copy(midPoint);

        // Rotate the laser beam to point from startPosition to endPosition
        laserBeam.lookAt(endPosition);
        laserBeam.rotateX(Math.PI / 2);

        scene.add(laserBeam);

        // Optional: Add a light source at the start position
        const pointLight = new THREE.PointLight(color, 1, 1);
        pointLight.position.copy(startPosition);
        scene.add(pointLight);
    }

    // Example usage in your existing code
    const startPosition = new THREE.Vector3(0, 1, 0);  // Start of the laser beam
    const endPosition = new THREE.Vector3(0, 1, -2);   // End of the laser beam
    const laserColor = 0xffffff;                       // White color for the laser
    //addLaserBeam(scene, startPosition, endPosition, laserColor);

    function animate() {

        renderer.render( scene, camera );

        }
</script>
</body>
</html>
